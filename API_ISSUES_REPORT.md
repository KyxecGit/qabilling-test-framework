# üö® –ü–û–õ–ù–´–ô –û–¢–ß–Å–¢ –û–ë API –ü–†–û–ë–õ–ï–ú–ê–•

> **–î–∞—Ç–∞:** 26 –æ–∫—Ç—è–±—Ä—è 2025 –≥.  
> **–°—Ç–∞—Ç—É—Å:** 16 –ê–ö–¢–ò–í–ù–´–• –ü–†–û–ë–õ–ï–ú - –¢–†–ï–ë–£–Æ–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø  
> **–£—Ä–æ–≤–µ–Ω—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏:** –°–†–ï–î–ù–ò–ô-–í–´–°–û–ö–ò–ô  
> **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** 32 —Ç–µ—Å—Ç–∞, 16 —É–ø–∞–ª–æ (50%), 16 –ø—Ä–æ—à–ª–æ (50%)

---

## üìä –ë–´–°–¢–†–´–ô –û–ë–ó–û–†

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ü—Ä–∏–º–µ—Ä—ã |
|-----------|-----------|---------|
| **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP –∫–æ–¥—ã** | 10 | 204 –≤–º–µ—Å—Ç–æ 200, 201 –≤–º–µ—Å—Ç–æ 200, 400 –≤–º–µ—Å—Ç–æ 404 |
| **–ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π** | 5 | 403 –≤–º–µ—Å—Ç–æ 401 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–∫–µ–Ω–∞ |
| **–ü—Ä–æ–±–ª–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏** | 1 | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º ID |
| **–ò–¢–û–ì–û** | **16** | **–í—Å–µ —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è** |

---

## üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–û –¢–ò–ü–ê–ú –û–®–ò–ë–û–ö

### 1Ô∏è‚É£ **–ü–†–û–ë–õ–ï–ú–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò** (5 –æ—à–∏–±–æ–∫)
**–°—É—Ç—å:** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 403 (Forbidden) –≤–º–µ—Å—Ç–æ 401 (Unauthorized) –∫–æ–≥–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

#### –ì–¥–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è:
```
‚ùå AuthApiTest.shouldRejectInvalidToken (—Å—Ç—Ä–æ–∫–∞ 42)
‚ùå AuthApiTest.shouldRejestRequestWithoutToken (—Å—Ç—Ä–æ–∫–∞ 51)
‚ùå BalanceApiTest.shouldNotGetBalanceWithoutAuth (—Å—Ç—Ä–æ–∫–∞ 154)
‚ùå BalanceApiTest.shouldNotUpdateBalanceWithoutAuth (—Å—Ç—Ä–æ–∫–∞ 168)
‚ùå CounterApiTest.shouldNotGetCounterWithoutAuth (—Å—Ç—Ä–æ–∫–∞ 48)
‚ùå ProfileApiTest.shouldFailToCreateProfileWithoutAuth (—Å—Ç—Ä–æ–∫–∞ 221)
‚ùå ProfileApiTest.shouldFailToGetProfileWithoutAuth (—Å—Ç—Ä–æ–∫–∞ 231)
```

#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
```
–¢–µ—Å—Ç –æ–∂–∏–¥–∞–µ—Ç:  401 Unauthorized
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: 403 Forbidden
```

#### –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–æ–¥–∞–º–∏:
- **401 Unauthorized:** "–¢—ã –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ—Ç —Ç–æ–∫–µ–Ω–∞)"
- **403 Forbidden:** "–¢—ã –Ω–µ –∏–º–µ–µ—à—å –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (–ø–ª–æ—Ö–æ–π —Ç–æ–∫–µ–Ω –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)"

#### –ü—Ä–∏—á–∏–Ω—ã (–≤–µ—Ä–æ—è—Ç–Ω—ã–µ):
1. **–û—à–∏–±–∫–∞ –≤ middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** - –Ω–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç "–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–∞" –∏ "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω"
2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è** - –≤—Å–µ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 403
3. **Bug –≤ Spring Security** - –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Spring, –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—à–∏–±–∫–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ API):
```java
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Å–µ–π—á–∞—Å):
@GetMapping("/profile")
public ResponseEntity<?> getProfile() {
    if (token == null) {
        return ResponseEntity.status(403).body("Access Denied");  // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥
    }
    // ...
}

// –ü–†–ê–í–ò–õ–¨–ù–û:
@GetMapping("/profile")
public ResponseEntity<?> getProfile() {
    if (token == null || token.isEmpty()) {
        return ResponseEntity.status(401).body("Unauthorized");  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥
    }
    if (!isTokenValid(token)) {
        return ResponseEntity.status(403).body("Forbidden");  // ‚úÖ –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω
    }
    // ...
}
```

#### –ò–º–ø–∞–∫—Ç:
üî¥ **–í–´–°–û–ö–ò–ô** - –ù–∞—Ä—É—à–∞–µ—Ç REST API standards, –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É

---

### 2Ô∏è‚É£ **–ü–†–û–ë–õ–ï–ú–ê HTTP –ö–û–î–û–í –î–õ–Ø –ü–†–û–§–ò–õ–ï–ô** (5 –æ—à–∏–±–æ–∫)
**–°—É—Ç—å:** –ú–µ—Ç–æ–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 201 (Created) –≤–º–µ—Å—Ç–æ 200 (OK)

#### –ì–¥–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è:
```
‚ùå ProfileApiTest.shouldCreateProfileWithValidData (—Å—Ç—Ä–æ–∫–∞ 59)
‚ùå ProfileApiTest.shouldCreateProfileWithSpecificParams (—Å—Ç—Ä–æ–∫–∞ 85)
‚ùå ProfileApiTest.shouldDeleteProfile (—Å—Ç—Ä–æ–∫–∞ 286)
```

#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
```
–¢–µ—Å—Ç –æ–∂–∏–¥–∞–µ—Ç:  200 OK
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: 201 Created
```

#### –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–æ–¥–∞–º–∏:
- **200 OK:** "–ó–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω"
- **201 Created:** "–†–µ—Å—É—Ä—Å —É—Å–ø–µ—à–Ω–æ –°–û–ó–î–ê–ù"

#### –ü—Ä–æ–±–ª–µ–º–∞:
201 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ–∑–¥–∞–Ω–∏—è (POST), –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö –Ω–æ–≤—ã–π —Ä–µ—Å—É—Ä—Å.  
–ù–æ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 201 –¥–∞–∂–µ –¥–ª—è DELETE –æ–ø–µ—Ä–∞—Ü–∏–∏ - —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!

#### –ü—Ä–∏–º–µ—Ä—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```
POST /api/profile/create ‚Üí 201 ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (—Ä–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω)
DELETE /api/profile/delete?id=123 ‚Üí 201 ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 200)
PUT /api/profile/update ‚Üí 201 ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 200)
```

#### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ API):
```java
// DELETE –æ–ø–µ—Ä–∞—Ü–∏—è
@DeleteMapping("/profile")
public ResponseEntity<?> deleteProfile(@RequestParam Integer id) {
    // ... —É–¥–∞–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å ...
    return ResponseEntity.ok().build();  // ‚úÖ 200 OK –≤–º–µ—Å—Ç–æ 201
}

// UPDATE –æ–ø–µ—Ä–∞—Ü–∏—è
@PutMapping("/profile")
public ResponseEntity<?> updateProfile(@RequestBody ProfileDto dto) {
    // ... –æ–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å ...
    return ResponseEntity.ok().build();  // ‚úÖ 200 OK –≤–º–µ—Å—Ç–æ 201
}
```

#### –ò–º–ø–∞–∫—Ç:
üü† **–°–†–ï–î–ù–ò–ô** - –ú–æ–∂–µ—Ç –∑–∞–ø—É—Ç–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤, –Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### 3Ô∏è‚É£ **–ü–†–û–ë–õ–ï–ú–ê HTTP –ö–û–î–û–í –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò** (1 –æ—à–∏–±–∫–∞)
**–°—É—Ç—å:** Endpoint –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 204 (No Content) –≤–º–µ—Å—Ç–æ 200 (OK)

#### –ì–¥–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è:
```
‚ùå AuthApiTest.shouldGetValidToken (—Å—Ç—Ä–æ–∫–∞ 32)
```

#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
```
–¢–µ—Å—Ç –æ–∂–∏–¥–∞–µ—Ç:  200 OK + —Ç–µ–ª–æ —Å —Ç–æ–∫–µ–Ω–æ–º
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: 204 No Content (–ë–ï–ó –¢–ï–õ–ê)
```

#### –†–∞–∑–Ω–∏—Ü–∞:
- **200 OK:** "–ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω, –≤–æ—Ç –æ—Ç–≤–µ—Ç (–≤ body)"
- **204 No Content:** "–ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω, –Ω–æ –æ—Ç–≤–µ—Ç–∞ –Ω–µ—Ç"

#### –ü—Ä–æ–±–ª–µ–º–∞:
POST /api/auth/sign_in –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–∫–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ!  
–ï—Å–ª–∏ –≤–µ—Ä–Ω—É—Ç—å 204 (No Content), —Ç–æ–∫–µ–Ω –Ω–µ–≥–¥–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—å.

#### –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–µ–π—á–∞—Å:
```
POST /api/auth/sign_in
Body: {"username": "superuser", "password": "Admin123!@#"}

Response:
  Status: 204 No Content
  Body: (–ü–£–°–¢–û) ‚ùå –ì–¥–µ —Ç–æ–∫–µ–Ω?!
```

#### –ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
POST /api/auth/sign_in
Body: {"username": "superuser", "password": "Admin123!@#"}

Response:
  Status: 200 OK ‚úÖ
  Body: {"content": {"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}
```

#### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ API):
```java
@PostMapping("/auth/sign_in")
public ResponseEntity<?> signIn(@RequestBody LoginRequest request) {
    // ... –ø—Ä–æ–≤–µ—Ä—è–µ–º credentials ...
    String token = generateToken(user);
    
    // ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
    return ResponseEntity.status(204).build();  // –ù–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞!
    
    // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
    return ResponseEntity.ok().body(new SignInResponse(token));
}
```

#### –ò–º–ø–∞–∫—Ç:
üî¥ **–í–´–°–û–ö–ò–ô** - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–æ–±—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–µ—Å—Ç—ã –Ω–µ –ø–æ–ª—É—á–∞—é—Ç —Ç–æ–∫–µ–Ω

---

### 4Ô∏è‚É£ **–ü–†–û–ë–õ–ï–ú–ê HTTP –ö–û–î–û–í –ë–ê–õ–ê–ù–°–ê** (4 –æ—à–∏–±–∫–∏)
**–°—É—Ç—å:** –û–ø–µ—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 400 (Bad Request) –≤–º–µ—Å—Ç–æ 200 (OK)

#### –ì–¥–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è:
```
‚ùå BalanceApiTest.shouldUpdateBalance (—Å—Ç—Ä–æ–∫–∞ 37)
‚ùå BalanceApiTest.shouldUpdateAndVerifyBalance (—Å—Ç—Ä–æ–∫–∞ 68)
```

#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
```
–¢–µ—Å—Ç –æ–∂–∏–¥–∞–µ—Ç:  200 OK (–±–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω)
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: 400 Bad Request (–æ—à–∏–±–∫–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ?!)
```

#### –†–∞–∑–Ω–∏—Ü–∞:
- **200 OK:** "–ë–∞–ª–∞–Ω—Å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω"
- **400 Bad Request:** "–ó–∞–ø—Ä–æ—Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫"

#### –ü—Ä–æ–±–ª–µ–º–∞:
–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –ü–†–ê–í–ò–õ–¨–ù–´–ú–ò –¥–∞–Ω–Ω—ã–º–∏, –Ω–æ API –≥–æ–≤–æ—Ä–∏—Ç "–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å".  
–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–ª–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

#### –ü—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
POST /api/balance/update
{
  "msisdn": "996800123456",
  "amount": 100,
  "operationType": "CREDIT"
}

Response: 400 Bad Request ‚ùå
–°–æ–æ–±—â–µ–Ω–∏–µ: ??? (–Ω–µ —É–∫–∞–∑–∞–Ω–æ, –∫–∞–∫–æ–µ –ø–æ–ª–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
```

#### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç MSISDN** - –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
2. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ** - —á—Ç–æ-—Ç–æ –∑–∞–±—ã–ª–∏ –≤ API —Å–ø–µ–∫–µ
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö** - –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞
4. **Bug –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** - —Å–µ—Ä–≤–µ—Ä –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ

#### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:
- **–ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ API:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- **–ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Ç–µ—Å—Ç–∞:** –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

```java
// –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Spring):
@PutMapping("/balance")
public ResponseEntity<?> updateBalance(@RequestBody BalanceUpdateRequest req) {
    if (req.getMsisdn() == null || req.getMsisdn().isEmpty()) {
        // ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        return ResponseEntity
            .badRequest()
            .body(new ErrorResponse("msisdn –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"));
    }
    // ... –æ–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å ...
    return ResponseEntity.ok().build();  // ‚úÖ 200 OK –µ—Å–ª–∏ –≤—Å—ë –ø—Ä–∞–≤–∏–ª—å–Ω–æ
}
```

#### –ò–º–ø–∞–∫—Ç:
üî¥ **–í–´–°–û–ö–ò–ô** - –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞) –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### 5Ô∏è‚É£ **–ü–†–û–ë–õ–ï–ú–ê –í–ê–õ–ò–î–ê–¶–ò–ò ID** (1 –æ—à–∏–±–∫–∞)
**–°—É—Ç—å:** API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 400 (Bad Request) –≤–º–µ—Å—Ç–æ 404 (Not Found) –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º ID

#### –ì–¥–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è:
```
‚ùå BalanceApiTest.shouldNotUpdateBalanceWithInvalidId (—Å—Ç—Ä–æ–∫–∞ 144)
‚ùå CounterApiTest.shouldNotGetCounterWithInvalidId (—Å—Ç—Ä–æ–∫–∞ 59)
```

#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
```
–¢–µ—Å—Ç –æ–∂–∏–¥–∞–µ—Ç:  404 Not Found (—Ç–∞–∫–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –Ω–µ—Ç)
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: 400 Bad Request (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID)
```

#### –†–∞–∑–Ω–∏—Ü–∞:
- **400 Bad Request:** "ID –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (–Ω–µ —á–∏—Å–ª–æ, —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –∏ —Ç.–¥.)"
- **404 Not Found:** "ID –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞, –Ω–æ —Ç–∞–∫–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"

#### –ü—Ä–∏–º–µ—Ä:
```
// –°–ª—É—á–∞–π 1: –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π ID (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
PUT /api/balance?id=abc123  ‚Üí 400 Bad Request ‚úÖ (ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ)

// –°–ª—É—á–∞–π 2: –í–∞–ª–∏–¥–Ω—ã–π ID, –Ω–æ —Ä–µ—Å—É—Ä—Å–∞ –Ω–µ—Ç
PUT /api/balance?id=9999999  ‚Üí 404 Not Found ‚úÖ (—Ç–∞–∫–æ–≥–æ ID –Ω–µ—Ç –≤ –ë–î)

// –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–µ–π—á–∞—Å API:
PUT /api/balance?id=9999999  ‚Üí 400 Bad Request ‚ùå (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û)
```

#### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):
```java
@PutMapping("/balance")
public ResponseEntity<?> updateBalance(@RequestParam Integer id, ...) {
    // ID –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (Integer), –Ω–æ —Ä–µ—Å—É—Ä—Å–∞ –Ω–µ—Ç
    Balance balance = repository.findById(id).orElse(null);
    
    if (balance == null) {
        return ResponseEntity.notFound().build();  // ‚úÖ 404 Not Found
    }
    
    // ... –æ–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å ...
    return ResponseEntity.ok().build();
}
```

#### –ò–º–ø–∞–∫—Ç:
üü† **–°–†–ï–î–ù–ò–ô** - –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### 6Ô∏è‚É£ **–ü–†–û–ë–õ–ï–ú–ê –î–û–°–¢–£–ü–ê –ö –°–ß–Å–¢–ß–ò–ö–ê–ú** (3 –æ—à–∏–±–∫–∏)
**–°—É—Ç—å:** GET –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Å—á—ë—Ç—á–∏–∫–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 403 (Forbidden) –≤–º–µ—Å—Ç–æ 200 (OK)

#### –ì–¥–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è:
```
‚ùå CounterApiTest.shouldGetCounterById (—Å—Ç—Ä–æ–∫–∞ 27)
‚ùå CounterApiTest.shouldGetAllActiveCounters (—Å—Ç—Ä–æ–∫–∞ 38)
```

#### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
```
–¢–µ—Å—Ç –æ–∂–∏–¥–∞–µ—Ç:  200 OK + —Å–ø–∏—Å–æ–∫ —Å—á—ë—Ç—á–∏–∫–æ–≤
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: 403 Forbidden (–¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω?!)
```

#### –†–∞–∑–Ω–∏—Ü–∞:
- **200 OK:** "–í–æ—Ç –¥–∞–Ω–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–æ–≤"
- **403 Forbidden:** "–¢—ã –Ω–µ –∏–º–µ–µ—à—å –¥–æ—Å—Ç—É–ø–∞"

#### –ü—Ä–æ–±–ª–µ–º–∞:
–¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ï–°–¢–¨ (–≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization), –Ω–æ API –≥–æ–≤–æ—Ä–∏—Ç "–¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω".  
–í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```
GET /api/counter/1
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

Response: 403 Forbidden ‚ùå
```

#### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (superuser) –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —á—Ç–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤**
2. **API –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ**
3. **–°—á—ë—Ç—á–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

#### –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):
```java
@GetMapping("/counter/{id}")
public ResponseEntity<?> getCounterById(@PathVariable Integer id, 
                                        @RequestHeader String authorization) {
    User user = getUserFromToken(authorization);  // –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–æ–∫–µ–Ω–∞
    
    if (user == null) {
        return ResponseEntity.status(401).build();  // 401 –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ—Å—Ç—É–ø
    if (!user.hasAccessToCounters()) {
        return ResponseEntity.status(403).build();  // 403 –µ—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤
    }
    
    Counter counter = counterRepository.findById(id).orElse(null);
    if (counter == null) {
        return ResponseEntity.notFound().build();  // 404 –µ—Å–ª–∏ —Å—á—ë—Ç—á–∏–∫–∞ –Ω–µ—Ç
    }
    
    return ResponseEntity.ok(counter);  // ‚úÖ 200 –µ—Å–ª–∏ –≤—Å—ë –æ–∫
}
```

#### –ò–º–ø–∞–∫—Ç:
üî¥ **–í–´–°–û–ö–ò–ô** - –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–æ–≤ –≤–æ–æ–±—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìà –ú–ê–¢–†–ò–¶–ê –í–õ–ò–Ø–ù–ò–Ø

| –ü—Ä–æ–±–ª–µ–º–∞ | API Endpoint | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ü—Ä—è–º–æ–π –∏–º–ø–∞–∫—Ç |
|----------|-------------|------------|---|
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (401/403) | `/api/auth/*`, `/api/profile/*`, `/api/balance/*`, `/api/counter/*` | üî¥ –í–´–°–û–ö–ê–Ø | –ù–∞—Ä—É—à–µ–Ω–∏–µ REST —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ |
| HTTP –∫–æ–¥—ã –ø—Ä–æ—Ñ–∏–ª–µ–π (201/200) | `/api/profile/create`, `/api/profile/delete` | üü† –°–†–ï–î–ù–Ø–Ø | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–º |
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç (204/200) | `/api/auth/sign_in` | üî¥ –í–´–°–û–ö–ê–Ø | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–æ–±—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| –ë–∞–ª–∞–Ω—Å (400/200) | `/api/balance/update` | üî¥ –í–´–°–û–ö–ê–Ø | –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| –í–∞–ª–∏–¥–∞—Ü–∏—è ID (400/404) | `/api/balance/update`, `/api/counter/*` | üü† –°–†–ï–î–ù–Ø–Ø | –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| –î–æ—Å—Ç—É–ø –∫ —Å—á—ë—Ç—á–∏–∫–∞–º (403/200) | `/api/counter/*` | üî¥ –í–´–°–û–ö–ê–Ø | –§—É–Ω–∫—Ü–∏—è –≤–æ–æ–±—â–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ |

---

## üîß –î–ï–ô–°–¢–í–ò–Ø –î–õ–Ø –†–ê–ó–†–ê–ë–û–¢–ß–ò–ö–û–í API

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1Ô∏è‚É£ (–ö–†–ò–¢–ò–ß–ù–û–ï - –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è)
1. ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –í–µ—Ä–Ω—É—Ç—å 401 –≤–º–µ—Å—Ç–æ 403 –∫–æ–≥–¥–∞ —Ç–æ–∫–µ–Ω–∞ –Ω–µ—Ç
2. ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í–µ—Ä–Ω—É—Ç—å 200 OK + —Ç–µ–ª–æ (—Ç–æ–∫–µ–Ω) –≤–º–µ—Å—Ç–æ 204
3. ‚úÖ **–ë–∞–ª–∞–Ω—Å:** –í–µ—Ä–Ω—É—Ç—å 200 OK –≤–º–µ—Å—Ç–æ 400 –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. ‚úÖ **–°—á—ë—Ç—á–∏–∫–∏:** –í–µ—Ä–Ω—É—Ç—å 200 OK –¥–ª—è GET –æ–ø–µ—Ä–∞—Ü–∏–π –µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2Ô∏è‚É£ (–í–ê–ñ–ù–û–ï - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ)
1. ‚úÖ **HTTP –∫–æ–¥—ã –ø—Ä–æ—Ñ–∏–ª–µ–π:** –í–µ—Ä–Ω—É—Ç—å 200 OK –¥–ª—è DELETE –≤–º–µ—Å—Ç–æ 201
2. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è ID:** –í–µ—Ä–Ω—É—Ç—å 404 Not Found –≤–º–µ—Å—Ç–æ 400 –∫–æ–≥–¥–∞ —Ä–µ—Å—É—Ä—Å–∞ –Ω–µ—Ç

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3Ô∏è‚É£ (–ñ–ï–õ–ê–¢–ï–õ–¨–ù–û–ï - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ)
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö (—á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
3. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ HTTP –∫–æ–¥–∞–º

---

## üìù –ß–ï–ö–õ–ò–°–¢ –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
[  ] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
[  ] –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω —Å–µ—Ä–≤–µ—Ä
[  ] –ó–∞–ø—É—â–µ–Ω—ã —Ç–µ—Å—Ç—ã: mvn test
[  ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ —É–º–µ–Ω—å—à–∏–ª–æ—Å—å
[  ] –û–ø–∏—Å–∞–Ω–æ –≤ changelog
[  ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
[  ] –ó–∞–ø—É—à–µ–Ω–æ –≤ git
```

---

## üìå –í–´–í–û–î–´

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** üî¥ **16 –æ—à–∏–±–æ–∫ = –ø—Ä–æ–µ–∫—Ç –ù–ï –ì–û–¢–û–í –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã (–Ω–∞—Ä—É—à–µ–Ω–∏–µ REST)
2. –ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π (403 –≤–º–µ—Å—Ç–æ 401)
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –æ—à–∏–±–æ–∫ (–æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–¥–∏—Ç—å)

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ 6 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—à–∏–±–æ–∫
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π REST API client code
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ CI/CD
- [ ] –û–±—É—á–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º HTTP –∫–æ–¥–∞–º

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å—Ä–æ–∫–∏:**
- **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–ø.1):** 1-2 –¥–Ω—è
- **–í–∞–∂–Ω—ã–µ (–ø.2):** 3-5 –¥–Ω–µ–π
- **–ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ (–ø.3):** 1-2 –Ω–µ–¥–µ–ª–∏

---

*–û—Ç—á—ë—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–º QABilling Test Framework v2.0*
